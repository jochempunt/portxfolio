---
import GithubIcon from "../assets/githubicon.svg?raw";
import MailIcon from "../assets/mailicon.svg?raw";
import LinkedinIcon from "../assets/linkedin.svg?raw";
import ExternalLinkIcon from "../assets/external-link.svg?raw";

interface Props {
  href?: string;
  label: string;
  special?: "Orange" | "Blue" | "Green" | "";
  email?: string;
  icon?: "github" | "linkedin" | "external";
}

const { href, label, special = "", email, icon } = Astro.props;

const isEmail = !!email;
const linkHref = isEmail ? "#" : href;
const target = isEmail ? undefined : "_blank";
const rel = isEmail ? undefined : "noopener noreferrer";

const icons = {
  github: GithubIcon,
  linkedin: LinkedinIcon,
  external: ExternalLinkIcon,
  mail: MailIcon,
};

// Determine which icon to use. 'mail' is automatic, others are explicit.
const iconName = isEmail ? "mail" : icon;
const iconSvg = iconName ? icons[iconName] : null;
---

<a
  href={linkHref}
  target={target}
  rel={rel}
  title={label}
  class={`github-link ${special}`}
  data-email={email}
>
  <span>{label}</span>
  {iconSvg && <Fragment set:html={iconSvg} />}
</a>

<script>
  // Simple email obfuscation
  document.querySelectorAll("a[data-email]").forEach((link) => {
    const setMailto = () => {
      const email = (link as HTMLElement).dataset.email;
      if (email && link.getAttribute("href") === "#") {
        link.setAttribute("href", `mailto:${email}`);
      }
    };

    // Set the href on first interaction (hover or focus) to avoid scrapers
    link.addEventListener("pointerenter", setMailto, { once: true });
    link.addEventListener("focus", setMailto, { once: true });
  });
</script>

<style>
  .github-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    background: #2b2b2b;
    border: 1px solid #3a3a3a;
    border-radius: 8px;
    color: #ffffff;
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 500;
    transition:
      background 0.2s ease,
      border-color 0.2s ease;

  }

  .github-link:hover {
    background: #333;
    border-color: #4a4a4a;
  }

  .github-link > :global(svg) {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
    opacity: 0.7;
    transition: opacity 0.2s ease;
  }

  .Orange{
    background-color: #ff835ad5;
  }

   .Orange:hover{
    background-color: #f09475ce;
  }

  .Blue{
    background-color: #5aaaffd2;
  }

  .Blue:hover{
    background-color: #6fb1f7cf;
  }

  .Green {
    background-color: #5ac8a0d5;
  }

  .Green:hover {
    background-color: #6cd8b0d5;
  }

  .github-link:hover > :global(svg) {
    opacity: 1;
  }
</style>
